# Reference this view as omni_dbt__base_exposure_relationships
schema_label: ""

schema: omni_dbt
table_name: BASE_EXPOSURE_RELATIONSHIPS

dimensions:
  resource_id:
    sql: '"RESOURCE_ID"'
    format: ID

  direct_parent_id:
    sql: '"DIRECT_PARENT_ID"'
    format: ID

  is_primary_relationship:
    sql: '"IS_PRIMARY_RELATIONSHIP"'

measures:
  count:
    aggregate_type: count

#The info below was pulled from your dbt repository and is read-only.
dbt:
  name: base_exposure_relationships
  target_schema: STAGING
  config:
    materialized: table
  code: |-
    {{
        config(
            materialized='table',
            post_hook="{{ insert_resources_from_graph(this, resource_type='exposures', relationships=True) }}"
        )
    }}

    {% if execute %}
        {{ check_model_is_table(model) }}
    {% endif %}

    /* Bigquery won't let us `where` without `from` so we use this workaround */
    with dummy_cte as (
        select 1 as foo
    ) 

    select 
        cast(null as {{ dbt_project_evaluator.type_string_dpe()}}) as resource_id,
        cast(null as {{ dbt_project_evaluator.type_string_dpe()}}) as direct_parent_id,
        cast(True as {{ dbt.type_boolean() }}) as is_primary_relationship

    from dummy_cte
    where false
  referenced_by: [ stg_exposure_relationships ]
