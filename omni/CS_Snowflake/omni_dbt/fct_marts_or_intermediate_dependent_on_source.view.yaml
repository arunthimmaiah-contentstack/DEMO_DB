# Reference this view as omni_dbt__fct_marts_or_intermediate_dependent_on_source
schema_label: ""
#This description was pulled from dbt.
description: This table shows each parent/child relationship where models in the
  marts and/or intermediate layer are dependent on source(s).

schema: omni_dbt
table_name: FCT_MARTS_OR_INTERMEDIATE_DEPENDENT_ON_SOURCE

dimensions:
  parent:
    sql: '"PARENT"'

  parent_resource_type:
    sql: '"PARENT_RESOURCE_TYPE"'

  child:
    sql: '"CHILD"'

  child_model_type:
    sql: '"CHILD_MODEL_TYPE"'

measures:
  count:
    aggregate_type: count

#The info below was pulled from your dbt repository and is read-only.
dbt:
  name: fct_marts_or_intermediate_dependent_on_source
  target_schema: STAGING
  description: This table shows each parent/child relationship where models in the
    marts and/or intermediate layer are dependent on source(s).
  config:
    materialized: table
  code: |-
    -- cases where a marts/intermediate model directly references a raw source
    with direct_relationships as (
        select  
            *
        from {{ ref('int_all_dag_relationships') }}
        where distance = 1
        and not parent_is_excluded
        and not child_is_excluded
    ),
    final as (
        select
            parent,
            parent_resource_type,
            child,
            child_model_type
        from direct_relationships
        where parent_resource_type = 'source'
        and child_model_type in ('marts', 'intermediate')
    )
    select * from final

    {{ filter_exceptions() }}
