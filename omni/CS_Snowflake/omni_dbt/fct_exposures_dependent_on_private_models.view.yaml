# Reference this view as omni_dbt__fct_exposures_dependent_on_private_models
schema_label: ""
#This description was pulled from dbt.
description: This table shows each direct relationship between a parent resource
  and a downstream exposure where the parent resource is not a public model

schema: omni_dbt
table_name: FCT_EXPOSURES_DEPENDENT_ON_PRIVATE_MODELS

dimensions:
  exposure_name:
    sql: '"EXPOSURE_NAME"'

  parent_resource_name:
    sql: '"PARENT_RESOURCE_NAME"'

  parent_access:
    sql: '"PARENT_ACCESS"'

  parent_resource_type:
    sql: '"PARENT_RESOURCE_TYPE"'

measures:
  count:
    aggregate_type: count

#The info below was pulled from your dbt repository and is read-only.
dbt:
  name: fct_exposures_dependent_on_private_models
  target_schema: STAGING
  description: This table shows each direct relationship between a parent resource
    and a downstream exposure where the parent resource is not a public model
  config:
    materialized: view
  code: |-
    with 

    direct_exposure_relationships as (
        select * from {{ ref('int_all_dag_relationships') }}
        where 
            distance = 1
            and child_resource_type = 'exposure'
            and not (
                    parent_resource_type = 'model'
                    and parent_is_public
                )
            and not parent_is_excluded
    ),

    final as (

        select 
            child as exposure_name,
            parent as parent_resource_name,
            parent_access,
            parent_resource_type

        from direct_exposure_relationships

    )

    select * from final

    {{ filter_exceptions() }}
