# Reference this view as staging__stg_salesforce__leads_stages
#This description was pulled from dbt.
description: Staging model for Salesforce Lead object. Cleans, standardizes, and
  filters active lead records for downstream analytics and reporting.

schema: STAGING
table_name: STG_SALESFORCE__LEADS_STAGES

dimensions:
  id:
    sql: '"ID"'
    format: ID
    #This description was pulled from dbt.
    description: Composite unique identifier for the lead record (concatenation of
      Salesforce ID and name).
    primary_key: true

  lead_id:
    sql: '"LEAD_ID"'
    format: ID

  external_lead_id:
    sql: '"EXTERNAL_LEAD_ID"'
    format: ID

  stage_date_mel_c:
    sql: '"STAGE_DATE_MEL_C"'

  stage_date_mql_v_2_c:
    sql: '"STAGE_DATE_MQL_V_2_C"'

  stage_date_sal_v_2_c:
    sql: '"STAGE_DATE_SAL_V_2_C"'

  stage_date_sql_v_2_c:
    sql: '"STAGE_DATE_SQL_V_2_C"'

measures:
  count:
    aggregate_type: count

#The info below was pulled from your dbt repository and is read-only.
dbt:
  name: stg_salesforce__leads_stages
  target_schema: STAGING
  description: Staging model for Salesforce Lead object. Cleans, standardizes, and
    filters active lead records for downstream analytics and reporting.
  config:
    schema: staging
    materialized: view
  code: |-
    with source as (
        select * from {{ source('sfdc_lead','lead')}} where is_deleted != 'TRUE'
    )

    select
        concat(id, '|', name) as id,     
        id as lead_id,                        
        lead_id as external_lead_id,
        stage_date_mel_c,
        stage_date_mql_v_2_c,
        stage_date_sal_v_2_c,
        stage_date_sql_v_2_c
    from source
  referenced_by:
    [
      mel_volume,
      mql_volume,
      sal_volume,
      sql_volume,
      mel_to_mql_conversion,
      mql_to_sal_conversion,
      sal_to_sql_conversion
    ]
