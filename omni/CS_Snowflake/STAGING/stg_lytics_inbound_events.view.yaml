# Reference this view as staging__stg_lytics_inbound_events
schema: STAGING
table_name: STG_LYTICS_INBOUND_EVENTS

dimensions:
  event_ts:
    sql: '"EVENT_TS"'

  event_date:
    sql: '"EVENT_DATE"'

  account_id:
    sql: '"ACCOUNT_ID"'
    format: ID

  account_name:
    sql: '"ACCOUNT_NAME"'

  org_id:
    sql: '"ORG_ID"'
    format: ID

  ingress_count:
    sql: '"INGRESS_COUNT"'

  bulk_count:
    sql: '"BULK_COUNT"'

  inbound_total_count:
    sql: '"INBOUND_TOTAL_COUNT"'

  period_start:
    sql: '"PERIOD_START"'

  period_end:
    sql: '"PERIOD_END"'

measures:
  count:
    aggregate_type: count

#The info below was pulled from your dbt repository and is read-only.
dbt:
  name: stg_lytics_inbound_events
  target_schema: STAGING
  config:
    schema: staging
    materialized: view
  code: |-
    with source as (
        select *
        from {{ source('lytics_data_share', 'lytics_inbound_events_raw') }}
    ),

    renamed as (
        select
            timestamp               as event_ts,
            date                    as event_date,
            account_id,
            account_name,
            lytics_org_id           as org_id,
            eventIngress_count      as ingress_count,
            bulkEvent_count         as bulk_count,
            total_count             as inbound_total_count,
            period_start,
            period_end
        from source
    )

    select * from renamed
  referenced_by: [ int_lytics_daily_usage ]
