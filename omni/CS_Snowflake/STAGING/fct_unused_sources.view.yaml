# Reference this view as staging__fct_unused_sources
#This description was pulled from dbt.
description: This table shows each source with 0 children.

schema: STAGING
table_name: FCT_UNUSED_SOURCES

dimensions:
  parent:
    sql: '"PARENT"'

measures:
  count:
    aggregate_type: count

#The info below was pulled from your dbt repository and is read-only.
dbt:
  name: fct_unused_sources
  target_schema: STAGING
  description: This table shows each source with 0 children.
  config:
    materialized: table
  code: |-
    -- this model finds cases where a source has no children

    with source_relationships as (
        select  
            *
        from {{ ref('int_all_dag_relationships') }}
        where parent_resource_type = 'source'
        and not parent_is_excluded
        and not child_is_excluded
    ),

    final as (
        select
            parent
        from source_relationships
        group by 1
        having max(distance) = 0
    )

    select * from final

    {{ filter_exceptions() }}
