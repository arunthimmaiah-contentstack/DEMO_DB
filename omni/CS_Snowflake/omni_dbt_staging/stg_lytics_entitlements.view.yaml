# Reference this view as omni_dbt_staging__stg_lytics_entitlements
schema_label: ""

schema: omni_dbt_staging
table_name: STG_LYTICS_ENTITLEMENTS

dimensions:
  event_ts:
    sql: '"EVENT_TS"'

  account_id:
    sql: '"ACCOUNT_ID"'
    format: ID

  account_name:
    sql: '"ACCOUNT_NAME"'

  org_id:
    sql: '"ORG_ID"'
    format: ID

  entitlement_id:
    sql: '"ENTITLEMENT_ID"'
    format: ID

  contentstack_uid:
    sql: '"CONTENTSTACK_UID"'

  entitlement_term_type:
    sql: '"ENTITLEMENT_TERM_TYPE"'

  entitlement_term_start_date:
    sql: '"ENTITLEMENT_TERM_START_DATE"'

  entitlement_term_end_date:
    sql: '"ENTITLEMENT_TERM_END_DATE"'

  inbound_entitlement:
    sql: '"INBOUND_ENTITLEMENT"'

  outbound_entitlement:
    sql: '"OUTBOUND_ENTITLEMENT"'

  aid:
    sql: '"AID"'

measures:
  count:
    aggregate_type: count

#The info below was pulled from your dbt repository and is read-only.
dbt:
  name: stg_lytics_entitlements
  target_schema: STAGING
  config:
    schema: staging
    materialized: view
  code: |-
    with source as (
        select * 
        from {{ source('lytics_data_share', 'lytics_entitlements_raw') }}
    ),

    renamed as (
        select
            timestamp               as event_ts,
            account_id,
            account_name,
            lytics_org_id          as org_id,
            entitlement_id,
            CONTENTSTACK_UID,
            entitlement_term_type,
            entitlement_term_start_date,
            entitlement_term_end_date,
            inbound_entitlement,
            outbound_entitlement,
        	aid

        from source
    )

    select * from renamed
  referenced_by: [ fct_lytics_entitlements ]
