# Reference this view as omni_dbt_staging__stg_lytics_outbound_events
schema_label: ""

schema: omni_dbt_staging
table_name: STG_LYTICS_OUTBOUND_EVENTS

dimensions:
  event_ts:
    sql: '"EVENT_TS"'

  event_date:
    sql: '"EVENT_DATE"'

  account_id:
    sql: '"ACCOUNT_ID"'
    format: ID

  account_name:
    sql: '"ACCOUNT_NAME"'

  org_id:
    sql: '"ORG_ID"'
    format: ID

  outbound_total_count:
    sql: '"OUTBOUND_TOTAL_COUNT"'

  period_start:
    sql: '"PERIOD_START"'

  period_end:
    sql: '"PERIOD_END"'

measures:
  count:
    aggregate_type: count

#The info below was pulled from your dbt repository and is read-only.
dbt:
  name: stg_lytics_outbound_events
  target_schema: STAGING
  config:
    schema: staging
    materialized: view
  code: |-
    with source as (
        select *
        from {{ source('lytics_data_share', 'lytics_outbound_events_raw') }}
    ),

    renamed as (
        select
            timestamp               as event_ts,
            date                    as event_date,
            account_id,
            account_name,
            lytics_org_id           as org_id,
            total_count             as outbound_total_count,
            period_start,
            period_end
        from source
    )

    select * from renamed
  referenced_by: [ int_lytics_daily_usage ]
