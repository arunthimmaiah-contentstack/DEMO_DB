# Reference this view as omni_dbt_staging__academy_certificates
schema_label: ""

schema: omni_dbt_staging
table_name: ACADEMY_CERTIFICATES

dimensions:
  data_sync_date:
    sql: '"DATA_SYNC_DATE"'

  uid:
    sql: '"UID"'

  created_at:
    sql: '"CREATED_AT"'

  updated_at:
    sql: '"UPDATED_AT"'

  user_email:
    sql: '"USER_EMAIL"'

  first_name:
    sql: '"FIRST_NAME"'

  last_name:
    sql: '"LAST_NAME"'

  company:
    sql: '"COMPANY"'

  user_uid:
    sql: '"USER_UID"'

  course_id:
    sql: '"COURSE_ID"'
    format: ID

  certificate_name:
    sql: '"CERTIFICATE_NAME"'

  cert_expires_at:
    sql: '"CERT_EXPIRES_AT"'

measures:
  count:
    aggregate_type: count

#The info below was pulled from your dbt repository and is read-only.
dbt:
  name: academy_certificates
  target_schema: STAGING
  config:
    schema: staging
    materialized: view
  code: |-
    select
        CONVERT_TIMEZONE('UTC', 'America/Los_Angeles', current_timestamp()::timestamp_ntz) AS data_sync_date,
        replace(user_certificates:uid, '"', '') as uid,
        replace(user_certificates:createdAt, '"', '') as created_at,
        replace(user_certificates:updatedAt, '"', '') as updated_at,
        replace(user_certificates:userUid:email, '"', '') as user_email,
        replace(user_certificates:userUid:firstName, '"', '') as first_name,
        replace(user_certificates:userUid:lastName, '"', '') as last_name,
        replace(user_certificates:userUid:company, '"', '') as company,
        replace(user_certificates:userUid:uid, '"', '') as user_uid,
        replace(user_certificates:learningPathEntryUid:entryMetadata:entryUid, '"', '') as course_id,
        replace(user_certificates:learningPathEntryUid:entryMetadata:title, '"', '') as certificate_name,
        replace(user_certificates:expiryAt, '"', '') as CERT_EXPIRES_AT
    from {{source('academy', 'academy_user_certificates')}}
  referenced_by: [ academy_partner_enrollments ]
