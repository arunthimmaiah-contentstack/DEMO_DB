# Reference this view as omni_dbt_marts__time_spine_daily
schema_label: ""
#This description was pulled from dbt.
description: A time spine with one row per day, ranging from 5 years in the past
  to 30 days into the future.

schema: omni_dbt_marts
table_name: TIME_SPINE_DAILY

dimensions:
  date_day:
    sql: '"DATE_DAY"'
    #This description was pulled from dbt.
    description: The base date column for daily granularity

measures:
  count:
    aggregate_type: count

#The info below was pulled from your dbt repository and is read-only.
dbt:
  name: time_spine_daily
  target_schema: STAGING
  description: A time spine with one row per day, ranging from 5 years in the past
    to 30 days into the future.
  config:
    schema: marts
    materialized: table
  code: |-
    {{
        config(
            materialized = 'table',
        )
    }}

    with

    base_dates as (
        {{
            dbt.date_spine(
                'day',
                "DATE('2000-01-01')",
                "DATE('2030-01-01')"
            )
        }}
    ),

    final as (
        select
            cast(date_day as date) as date_day
        from base_dates
    )

    select *
    from final
    where date_day > dateadd(year, -5, current_date())  -- Keep recent dates only
      and date_day < dateadd(day, 30, current_date())
  referenced_by: [ fct_salesforce_account_daily, int_salesforce_account_daily ]
